<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../">
  <title data-ice="title">src/PluginManager.js | typhonjs-plugin-manager API Document</title>
  <link type="text/css" rel="stylesheet" href="css/mdl/material.min.css">
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/mdl/material.override.css">
  <link type="text/css" rel="stylesheet" href="css/navigation/nav-accordion-style.css">
  <link type="text/css" rel="stylesheet" href="css/navigation/esdoc-nav-style.css">
  <link type="text/css" rel="stylesheet" href="css/scrollbar/webkit-style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">
<div id="contextpopup">
   <button id="context-menu" class="mdl-button mdl-js-button mdl-button--fab mdl-button--mini-fab mdl-js-ripple-effect hidden">
      <i class="material-icons">more_vert</i>
   </button>

   <ul class="mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="context-menu">
      <li class="mdl-menu__item hidden" data-action="openLink">Open on ...</li>
      <li class="mdl-menu__item hidden" data-action="openLink">Open on ...</li>
      <li disabled class="mdl-menu__item hidden">Version: ...</li>
   </ul>
</div>


<header>
  <a href="./">Home</a>
  <a href="./manual/index.html" data-ice="manualHeaderLink">Manual</a>
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  <a href="test.html" data-ice="testLink">Test</a>
  <a data-ice="repoURL" href="https://github.com/typhonjs-node-plugin/typhonjs-plugin-manager.git" class="repo-url-github">Repository</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><ul class="nav-accordion-menu animated hidden" data-nav-id="docs-nav-id-1487663229414" data-ice="navData">
<li data-ice="navGroup" class="has-children"><input type="checkbox" name="group-0" id="group-0" checked><label for="group-0" class="nav-header">Local Source</label>
   <ul>
      
   <li data-ice="navFolder" class="has-children"><input type="checkbox" name="folder-0" id="folder-0" checked><label for="folder-0" class="nav-dir-path" data-scm-link="https://github.com/typhonjs-node-plugin/typhonjs-plugin-manager/tree/master/src" data-scm-type="github">src</label>
         <ul>
            
         <li data-ice="navFile" class="has-children nav-accordion-file"><input type="checkbox" name="file-0" id="file-0" checked><label for="file-0" class="nav-file hidden" data-scm-link="https://github.com/typhonjs-node-plugin/typhonjs-plugin-manager/tree/master/src/PluginEntry.js" data-scm-type="github">PluginEntry.js</label>
               <ul>
                  
               <li data-ice="doc" class="nav-kind-class"><span data-ice="docLink"><a href="class/src/PluginEntry.js~PluginEntry.html" data-scm-link="https://github.com/typhonjs-node-plugin/typhonjs-plugin-manager/tree/master/src/PluginEntry.js#L4" data-scm-type="github">PluginEntry</a></span></li>
</ul>
            </li>
<li data-ice="navFile" class="has-children nav-accordion-file"><input type="checkbox" name="file-1" id="file-1" checked><label for="file-1" class="nav-file hidden" data-scm-link="https://github.com/typhonjs-node-plugin/typhonjs-plugin-manager/tree/master/src/PluginEvent.js" data-scm-type="github">PluginEvent.js</label>
               <ul>
                  
               <li data-ice="doc" class="nav-kind-class"><span data-ice="docLink"><a href="class/src/PluginEvent.js~PluginEvent.html" data-scm-link="https://github.com/typhonjs-node-plugin/typhonjs-plugin-manager/tree/master/src/PluginEvent.js#L10" data-scm-type="github">PluginEvent</a></span></li>
</ul>
            </li>
<li data-ice="navFile" class="has-children nav-accordion-file"><input type="checkbox" name="file-2" id="file-2" checked><label for="file-2" class="nav-file hidden" data-scm-link="https://github.com/typhonjs-node-plugin/typhonjs-plugin-manager/tree/master/src/PluginManager.js" data-scm-type="github">PluginManager.js</label>
               <ul>
                  
               <li data-ice="doc" class="nav-kind-class"><span data-ice="docLink"><a href="class/src/PluginManager.js~PluginManager.html" data-scm-link="https://github.com/typhonjs-node-plugin/typhonjs-plugin-manager/tree/master/src/PluginManager.js#L129" data-scm-type="github">PluginManager</a></span></li>
</ul>
            </li>
</ul>
      </li>
<li data-ice="navFolder" class="has-children"><input type="checkbox" name="folder-1" id="folder-1" checked><label for="folder-1" class="nav-dir-path" data-scm-link="https://github.com/typhonjs-node-plugin/typhonjs-plugin-manager/tree/master/src/types" data-scm-type="github">src/types</label>
         <ul>
            
         <li data-ice="navFile" class="has-children nav-accordion-file"><input type="checkbox" name="file-3" id="file-3" checked><label for="file-3" class="nav-file" data-scm-link="https://github.com/typhonjs-node-plugin/typhonjs-plugin-manager/tree/master/src/types/types.js" data-scm-type="github">types.js</label>
               <ul>
                  
               <li data-ice="doc" class="nav-kind-typedef"><span data-ice="docLink"><a href="typedef/index.html#static-typedef-PluginConfig" data-scm-link="https://github.com/typhonjs-node-plugin/typhonjs-plugin-manager/tree/master/src/types/types.js" data-scm-type="github">PluginConfig</a></span></li>
<li data-ice="doc" class="nav-kind-typedef"><span data-ice="docLink"><a href="typedef/index.html#static-typedef-PluginData" data-scm-link="https://github.com/typhonjs-node-plugin/typhonjs-plugin-manager/tree/master/src/types/types.js" data-scm-type="github">PluginData</a></span></li>
<li data-ice="doc" class="nav-kind-typedef"><span data-ice="docLink"><a href="typedef/index.html#static-typedef-PluginManagerOptions" data-scm-link="https://github.com/typhonjs-node-plugin/typhonjs-plugin-manager/tree/master/src/types/types.js" data-scm-type="github">PluginManagerOptions</a></span></li>
<li data-ice="doc" class="nav-kind-external"><span data-ice="docLink"><a href="external/index.html" data-scm-link="https://github.com/typhonjs-node-plugin/typhonjs-plugin-manager/tree/master/src/types/types.js" data-scm-type="github">EventProxy</a></span></li>
<li data-ice="doc" class="nav-kind-external"><span data-ice="docLink"><a href="external/index.html" data-scm-link="https://github.com/typhonjs-node-plugin/typhonjs-plugin-manager/tree/master/src/types/types.js" data-scm-type="github">TyphonEvents</a></span></li>
</ul>
            </li>
</ul>
      </li>
</ul>
</li>
</ul></nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/PluginManager.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import { assert }    from &apos;chai&apos;;
import EventProxy    from &apos;backbone-esnext-events/src/EventProxy&apos;;
import TyphonEvents  from &apos;backbone-esnext-events/src/TyphonEvents&apos;;

import PluginManager from &apos;../../src/PluginManager.js&apos;;

class PluginTest { test(event) { event.data.result.count++; assert.strictEqual(event.pluginName, &apos;PluginTest&apos;); } }

const pluginTest = { test: (event) =&gt; { event.data.result.count++; assert.strictEqual(event.pluginName, &apos;pluginTest&apos;); } };

// class PluginTestNoName { test(event) { event.data.result.count++; } }
class PluginTestNoName2 { test2(event) { event.data.result.count++; } }

class PluginTestSync
{
   constructor() { this.c = 3; }
   test(a, b) { return a + b + this.c; }
}

suite(&apos;PluginManager:&apos;, () =&gt;
{
   let pluginManager, testData;

   beforeEach(() =&gt; { pluginManager = new PluginManager(); testData = { result: { count: 0 } }; });

   test(&apos;PluginManager constructor function is exported&apos;, () =&gt;
   {
      assert.isFunction(PluginManager);
   });

   test(&apos;PluginManager instance is object&apos;, () =&gt;
   {
      assert.isObject(pluginManager);
   });

   test(&apos;PluginManager throws when invoke is called with empty parameters&apos;, () =&gt;
   {
      assert.throws(() =&gt; { pluginManager.invokeSyncEvent(); });
   });

   test(&apos;PluginManager throws w/ add (no options)&apos;, () =&gt;
   {
      assert.throws(() =&gt; { pluginManager.add(); });
   });

   test(&apos;PluginManager return undefined for createEventProxy when no eventbus is assigned&apos;, () =&gt;
   {
      assert.isUndefined(pluginManager.createEventProxy());
   });

   test(&apos;PluginManager returns EventProxy for createEventProxy when eventbus is assigned&apos;, () =&gt;
   {
      pluginManager = new PluginManager({ eventbus: new TyphonEvents() });
      assert.isTrue(pluginManager.createEventProxy() instanceof EventProxy);
   });

   test(&apos;PluginManager has empty result&apos;, () =&gt;
   {
      const event = pluginManager.invokeSyncEvent(&apos;test&apos;);

      assert.isObject(event);
      assert.lengthOf(Object.keys(event), 2);
      assert(event.$$plugin_invoke_count === 0);
   });

   test(&apos;PluginManager w/ plugin and missing method has empty event result&apos;, () =&gt;
   {
      pluginManager.add({ name: &apos;PluginTest&apos;, instance: new PluginTest() });

      const event = pluginManager.invokeSyncEvent(&apos;nop&apos;);

      assert.isObject(event);
      assert.lengthOf(Object.keys(event), 2);
      assert.strictEqual(event.$$plugin_invoke_count, 0);
   });

   test(&apos;PluginManager has valid test / class result (pass through)&apos;, () =&gt;
   {
      pluginManager.add({ name: &apos;PluginTest&apos;, instance: new PluginTest() });

      const event = pluginManager.invokeSyncEvent(&apos;test&apos;, void 0, testData);

      assert.isObject(event);
      assert.strictEqual(event.result.count, 1);
      assert.strictEqual(testData.result.count, 1);
      assert.strictEqual(event.$$plugin_invoke_count, 1);
   });

   test(&apos;PluginManager has valid test / object result (pass through)&apos;, () =&gt;
   {
      pluginManager.add({ name: &apos;pluginTest&apos;, instance: pluginTest });

      const event = pluginManager.invokeSyncEvent(&apos;test&apos;, void 0, testData);

      assert.isObject(event);
      assert.strictEqual(event.result.count, 1);
      assert.strictEqual(testData.result.count, 1);
   });

   test(&apos;PluginManager has invoked both plugins (pass through)&apos;, () =&gt;
   {
      pluginManager.add({ name: &apos;PluginTest&apos;, instance: new PluginTest() });
      pluginManager.add({ name: &apos;pluginTest&apos;, instance: pluginTest });

      const event = pluginManager.invokeSyncEvent(&apos;test&apos;, void 0, testData);

      assert.isObject(event);
      assert.strictEqual(event.result.count, 2);
      assert.strictEqual(testData.result.count, 2);
   });

   test(&apos;PluginManager has valid test / class result (copy)&apos;, () =&gt;
   {
      pluginManager.add({ name: &apos;PluginTest&apos;, instance: new PluginTest() });

      const event = pluginManager.invokeSyncEvent(&apos;test&apos;, testData);

      assert.isObject(event);
      assert.strictEqual(event.result.count, 1);
      assert.strictEqual(testData.result.count, 0);
      assert.strictEqual(event.$$plugin_invoke_count, 1);
      assert.strictEqual(event.$$plugin_invoke_names[0], &apos;PluginTest&apos;);
   });

   test(&apos;PluginManager has valid test / object result (copy)&apos;, () =&gt;
   {
      pluginManager.add({ name: &apos;pluginTest&apos;, instance: pluginTest });

      const event = pluginManager.invokeSyncEvent(&apos;test&apos;, testData);

      assert.isObject(event);
      assert.strictEqual(event.result.count, 1);
      assert.strictEqual(testData.result.count, 0);
   });

   test(&apos;PluginManager has invoked both plugins (copy)&apos;, () =&gt;
   {
      pluginManager.add({ name: &apos;PluginTest&apos;, instance: new PluginTest() });
      pluginManager.add({ name: &apos;pluginTest&apos;, instance: pluginTest });

      const event = pluginManager.invokeSyncEvent(&apos;test&apos;, testData);

      assert.isObject(event);
      assert.strictEqual(event.result.count, 2);
      assert.strictEqual(testData.result.count, 0);
   });

   test(&apos;PluginManager has invoked one result (sync)&apos;, () =&gt;
   {
      pluginManager.add({ name: &apos;PluginTestSync&apos;, instance: new PluginTestSync() });

      const result = pluginManager.invokeSync(&apos;PluginTestSync&apos;, &apos;test&apos;, 1, 2);

      assert.isNumber(result);
      assert.strictEqual(result, 6);
   });

   test(&apos;PluginManager has invoked two results (sync)&apos;, () =&gt;
   {
      pluginManager.add({ name: &apos;PluginTestSync&apos;, instance: new PluginTestSync() });
      pluginManager.add({ name: &apos;PluginTestSync2&apos;, instance: new PluginTestSync() });

      const result = pluginManager.invokeSync(void 0, &apos;test&apos;, 1, 2);

      assert.isArray(result);
      assert.strictEqual(result[0], 6);
      assert.strictEqual(result[1], 6);
   });

   test(&apos;PluginConfig is valid&apos;, () =&gt;
   {
      assert.isTrue(pluginManager.isValidConfig({ name: &apos;test&apos; }));
      assert.isTrue(pluginManager.isValidConfig({ name: &apos;test&apos;, target: &apos;target&apos; }));
      assert.isTrue(pluginManager.isValidConfig({ name: &apos;test&apos;, target: &apos;target&apos;, options: {} }));
      assert.isTrue(pluginManager.isValidConfig({ name: &apos;test&apos;, options: {} }));
   });

   test(&apos;PluginConfig is invalid&apos;, () =&gt;
   {
      assert.isFalse(pluginManager.isValidConfig());
      assert.isFalse(pluginManager.isValidConfig({}));
      assert.isFalse(pluginManager.isValidConfig({ name: 123 }));
      assert.isFalse(pluginManager.isValidConfig({ target: &apos;target&apos; }));
      assert.isFalse(pluginManager.isValidConfig({ options: {} }));
      assert.isFalse(pluginManager.isValidConfig({ name: &apos;test&apos;, target: 123 }));
      assert.isFalse(pluginManager.isValidConfig({ name: &apos;test&apos;, target: &apos;target&apos;, options: 123 }));
      assert.isFalse(pluginManager.isValidConfig({ name: &apos;test&apos;, options: 123 }));
   });

   test(&apos;PluginManager get unique method names&apos;, () =&gt;
   {
      pluginManager.add({ name: &apos;PluginTestSync&apos;, instance: new PluginTestSync() });
      pluginManager.add({ name: &apos;PluginTestNoName2&apos;, instance: new PluginTestNoName2() });

      const results = pluginManager.getMethodNames();

      assert.isArray(results);
      assert.lengthOf(results, 2);
      assert.strictEqual(results[0], &apos;test&apos;);
      assert.strictEqual(results[1], &apos;test2&apos;);
   });

   test(&apos;PluginManager get plugin names&apos;, () =&gt;
   {
      pluginManager.add({ name: &apos;PluginTestSync&apos;, instance: new PluginTestSync() });
      pluginManager.add({ name: &apos;PluginTestSync2&apos;, instance: new PluginTestSync() });

      const results = pluginManager.getPluginNames();

      assert.isArray(results);
      assert.lengthOf(results, 2);
      assert.strictEqual(results[0], &apos;PluginTestSync&apos;);
      assert.strictEqual(results[1], &apos;PluginTestSync2&apos;);
   });

   test(&apos;PluginManager get plugin / method names&apos;, () =&gt;
   {
      pluginManager.add({ name: &apos;PluginTestSync&apos;, instance: new PluginTestSync() });
      pluginManager.add({ name: &apos;PluginTestNoName2&apos;, instance: new PluginTestNoName2() });

      const results = pluginManager.getPluginMethodNames();

      assert.isArray(results);
      assert.lengthOf(results, 2);
      assert.strictEqual(results[0].plugin, &apos;PluginTestSync&apos;);
      assert.strictEqual(results[0].method, &apos;test&apos;);
      assert.strictEqual(results[1].plugin, &apos;PluginTestNoName2&apos;);
      assert.strictEqual(results[1].method, &apos;test2&apos;);
   });
});
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.5.0-alpha)</span></a>
</footer>

<script src="script/jquery/jquery.min.js"></script>
<script src="script/navigation/enhancednav.js"></script>
<script defer src="script/mdl/material.min.js"></script>
<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
