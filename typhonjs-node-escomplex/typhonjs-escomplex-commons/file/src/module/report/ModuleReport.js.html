<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../../">
  <title data-ice="title">src/module/report/ModuleReport.js | typhonjs-escomplex-commons API Document</title>
  <link type="text/css" rel="stylesheet" href="css/mdl/material.min.css">
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/mdl/material.override.css">
  <link type="text/css" rel="stylesheet" href="css/navigation/nav-accordion-style.css">
  <link type="text/css" rel="stylesheet" href="css/navigation/esdoc-nav-style.css">
  <link type="text/css" rel="stylesheet" href="css/scrollbar/webkit-style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">
<div id="contextpopup">
   <button id="context-menu" class="mdl-button mdl-js-button mdl-button--fab mdl-button--mini-fab mdl-js-ripple-effect hidden">
      <i class="material-icons">more_vert</i>
   </button>

   <ul class="mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="context-menu">
      <li class="mdl-menu__item hidden" data-action="openLink">Open on ...</li>
      <li class="mdl-menu__item hidden" data-action="openLink">Open on ...</li>
      <li disabled class="mdl-menu__item hidden">Version: ...</li>
   </ul>
</div>


<header>
  <a href="./">Home</a>
  <a href="./manual/index.html" data-ice="manualHeaderLink">Manual</a>
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <a data-ice="repoURL" href="https://github.com/typhonjs-node-escomplex/typhonjs-escomplex-commons.git" class="repo-url-github">Repository</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><ul class="nav-accordion-menu animated hidden" data-nav-id="docs-nav-id-1467272605735" data-ice="navData">
<li data-ice="navGroup" class="has-children"><input type="checkbox" name="group-0" id="group-0" checked><label for="group-0" class="nav-header">Local Source</label>
   <ul>
      
   <li data-ice="navFolder" class="has-children"><input type="checkbox" name="folder-0" id="folder-0" checked><label for="folder-0" class="nav-dir-path" data-scm-link="https://github.com/typhonjs-node-escomplex/typhonjs-escomplex-commons/tree/master/src/module/plugin/syntax" data-scm-type="github">src/module/plugin/syntax</label>
         <ul>
            
         <li data-ice="navFile" class="has-children nav-accordion-file"><input type="checkbox" name="file-0" id="file-0" checked><label for="file-0" class="nav-file hidden" data-scm-link="https://github.com/typhonjs-node-escomplex/typhonjs-escomplex-commons/tree/master/src/module/plugin/syntax/AbstractSyntaxLoader.js" data-scm-type="github">AbstractSyntaxLoader.js</label>
               <ul>
                  
               <li data-ice="doc" class="nav-kind-class"><span data-ice="docLink"><a href="class/src/module/plugin/syntax/AbstractSyntaxLoader.js~AbstractSyntaxLoader.html" data-scm-link="https://github.com/typhonjs-node-escomplex/typhonjs-escomplex-commons/tree/master/src/module/plugin/syntax/AbstractSyntaxLoader.js#L8" data-scm-type="github">AbstractSyntaxLoader</a></span></li>
</ul>
            </li>
</ul>
      </li>
<li data-ice="navFolder" class="has-children"><input type="checkbox" name="folder-1" id="folder-1" checked><label for="folder-1" class="nav-dir-path" data-scm-link="https://github.com/typhonjs-node-escomplex/typhonjs-escomplex-commons/tree/master/src/module/report" data-scm-type="github">src/module/report</label>
         <ul>
            
         <li data-ice="navFile" class="has-children nav-accordion-file"><input type="checkbox" name="file-1" id="file-1" checked><label for="file-1" class="nav-file hidden" data-scm-link="https://github.com/typhonjs-node-escomplex/typhonjs-escomplex-commons/tree/master/src/module/report/AbstractReport.js" data-scm-type="github">AbstractReport.js</label>
               <ul>
                  
               <li data-ice="doc" class="nav-kind-class"><span data-ice="docLink"><a href="class/src/module/report/AbstractReport.js~AbstractReport.html" data-scm-link="https://github.com/typhonjs-node-escomplex/typhonjs-escomplex-commons/tree/master/src/module/report/AbstractReport.js#L7" data-scm-type="github">AbstractReport</a></span></li>
</ul>
            </li>
<li data-ice="navFile" class="has-children nav-accordion-file"><input type="checkbox" name="file-2" id="file-2" checked><label for="file-2" class="nav-file hidden" data-scm-link="https://github.com/typhonjs-node-escomplex/typhonjs-escomplex-commons/tree/master/src/module/report/ClassReport.js" data-scm-type="github">ClassReport.js</label>
               <ul>
                  
               <li data-ice="doc" class="nav-kind-class"><span data-ice="docLink"><a href="class/src/module/report/ClassReport.js~ClassReport.html" data-scm-link="https://github.com/typhonjs-node-escomplex/typhonjs-escomplex-commons/tree/master/src/module/report/ClassReport.js#L9" data-scm-type="github">ClassReport</a></span></li>
</ul>
            </li>
<li data-ice="navFile" class="has-children nav-accordion-file"><input type="checkbox" name="file-3" id="file-3" checked><label for="file-3" class="nav-file hidden" data-scm-link="https://github.com/typhonjs-node-escomplex/typhonjs-escomplex-commons/tree/master/src/module/report/HalsteadData.js" data-scm-type="github">HalsteadData.js</label>
               <ul>
                  
               <li data-ice="doc" class="nav-kind-class"><span data-ice="docLink"><a href="class/src/module/report/HalsteadData.js~HalsteadData.html" data-scm-link="https://github.com/typhonjs-node-escomplex/typhonjs-escomplex-commons/tree/master/src/module/report/HalsteadData.js#L7" data-scm-type="github">HalsteadData</a></span></li>
</ul>
            </li>
<li data-ice="navFile" class="has-children nav-accordion-file"><input type="checkbox" name="file-4" id="file-4" checked><label for="file-4" class="nav-file hidden" data-scm-link="https://github.com/typhonjs-node-escomplex/typhonjs-escomplex-commons/tree/master/src/module/report/MethodReport.js" data-scm-type="github">MethodReport.js</label>
               <ul>
                  
               <li data-ice="doc" class="nav-kind-class"><span data-ice="docLink"><a href="class/src/module/report/MethodReport.js~MethodReport.html" data-scm-link="https://github.com/typhonjs-node-escomplex/typhonjs-escomplex-commons/tree/master/src/module/report/MethodReport.js#L9" data-scm-type="github">MethodReport</a></span></li>
</ul>
            </li>
<li data-ice="navFile" class="has-children nav-accordion-file"><input type="checkbox" name="file-5" id="file-5" checked><label for="file-5" class="nav-file hidden" data-scm-link="https://github.com/typhonjs-node-escomplex/typhonjs-escomplex-commons/tree/master/src/module/report/ModuleReport.js" data-scm-type="github">ModuleReport.js</label>
               <ul>
                  
               <li data-ice="doc" class="nav-kind-class"><span data-ice="docLink"><a href="class/src/module/report/ModuleReport.js~ModuleReport.html" data-scm-link="https://github.com/typhonjs-node-escomplex/typhonjs-escomplex-commons/tree/master/src/module/report/ModuleReport.js#L10" data-scm-type="github">ModuleReport</a></span></li>
</ul>
            </li>
</ul>
      </li>
<li data-ice="navFolder" class="has-children"><input type="checkbox" name="folder-2" id="folder-2" checked><label for="folder-2" class="nav-dir-path" data-scm-link="https://github.com/typhonjs-node-escomplex/typhonjs-escomplex-commons/tree/master/src/module/traits" data-scm-type="github">src/module/traits</label>
         <ul>
            
         <li data-ice="navFile" class="has-children nav-accordion-file"><input type="checkbox" name="file-6" id="file-6" checked><label for="file-6" class="nav-file hidden" data-scm-link="https://github.com/typhonjs-node-escomplex/typhonjs-escomplex-commons/tree/master/src/module/traits/HalsteadArray.js" data-scm-type="github">HalsteadArray.js</label>
               <ul>
                  
               <li data-ice="doc" class="nav-kind-class"><span data-ice="docLink"><a href="class/src/module/traits/HalsteadArray.js~HalsteadArray.html" data-scm-link="https://github.com/typhonjs-node-escomplex/typhonjs-escomplex-commons/tree/master/src/module/traits/HalsteadArray.js#L9" data-scm-type="github">HalsteadArray</a></span></li>
</ul>
            </li>
<li data-ice="navFile" class="has-children nav-accordion-file"><input type="checkbox" name="file-7" id="file-7" checked><label for="file-7" class="nav-file hidden" data-scm-link="https://github.com/typhonjs-node-escomplex/typhonjs-escomplex-commons/tree/master/src/module/traits/Trait.js" data-scm-type="github">Trait.js</label>
               <ul>
                  
               <li data-ice="doc" class="nav-kind-class"><span data-ice="docLink"><a href="class/src/module/traits/Trait.js~Trait.html" data-scm-link="https://github.com/typhonjs-node-escomplex/typhonjs-escomplex-commons/tree/master/src/module/traits/Trait.js#L6" data-scm-type="github">Trait</a></span></li>
</ul>
            </li>
<li data-ice="navFile" class="has-children nav-accordion-file"><input type="checkbox" name="file-8" id="file-8" checked><label for="file-8" class="nav-file hidden" data-scm-link="https://github.com/typhonjs-node-escomplex/typhonjs-escomplex-commons/tree/master/src/module/traits/TraitHalstead.js" data-scm-type="github">TraitHalstead.js</label>
               <ul>
                  
               <li data-ice="doc" class="nav-kind-class"><span data-ice="docLink"><a href="class/src/module/traits/TraitHalstead.js~TraitHalstead.html" data-scm-link="https://github.com/typhonjs-node-escomplex/typhonjs-escomplex-commons/tree/master/src/module/traits/TraitHalstead.js#L7" data-scm-type="github">TraitHalstead</a></span></li>
</ul>
            </li>
<li data-ice="navFile" class="has-children nav-accordion-file"><input type="checkbox" name="file-9" id="file-9" checked><label for="file-9" class="nav-file hidden" data-scm-link="https://github.com/typhonjs-node-escomplex/typhonjs-escomplex-commons/tree/master/src/module/traits/actualize.js" data-scm-type="github">actualize.js</label>
               <ul>
                  
               <li data-ice="doc" class="nav-kind-function"><span data-ice="docLink"><a href="function/index.html#static-function-actualize" data-scm-link="https://github.com/typhonjs-node-escomplex/typhonjs-escomplex-commons/tree/master/src/module/traits/actualize.js#L21" data-scm-type="github">actualize</a></span></li>
</ul>
            </li>
<li data-ice="navFile" class="has-children nav-accordion-file"><input type="checkbox" name="file-10" id="file-10" checked><label for="file-10" class="nav-file hidden" data-scm-link="https://github.com/typhonjs-node-escomplex/typhonjs-escomplex-commons/tree/master/src/module/traits/safeArray.js" data-scm-type="github">safeArray.js</label>
               <ul>
                  
               <li data-ice="doc" class="nav-kind-function"><span data-ice="docLink"><a href="function/index.html#static-function-safeArray" data-scm-link="https://github.com/typhonjs-node-escomplex/typhonjs-escomplex-commons/tree/master/src/module/traits/safeArray.js#L10" data-scm-type="github">safeArray</a></span></li>
</ul>
            </li>
<li data-ice="navFile" class="has-children nav-accordion-file"><input type="checkbox" name="file-11" id="file-11" checked><label for="file-11" class="nav-file hidden" data-scm-link="https://github.com/typhonjs-node-escomplex/typhonjs-escomplex-commons/tree/master/src/module/traits/safeName.js" data-scm-type="github">safeName.js</label>
               <ul>
                  
               <li data-ice="doc" class="nav-kind-function"><span data-ice="docLink"><a href="function/index.html#static-function-safeName" data-scm-link="https://github.com/typhonjs-node-escomplex/typhonjs-escomplex-commons/tree/master/src/module/traits/safeName.js#L11" data-scm-type="github">safeName</a></span></li>
</ul>
            </li>
</ul>
      </li>
</ul>
</li>
</ul></nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/module/report/ModuleReport.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">&apos;use strict&apos;;

import AbstractReport   from &apos;./AbstractReport.js&apos;;
import ClassReport      from &apos;./ClassReport.js&apos;;
import MethodReport     from &apos;./MethodReport.js&apos;;

/**
 * Provides the default report object which stores data pertaining to a single file / module being processed.
 */
export default class ModuleReport extends AbstractReport
{
   /**
    * Initializes the report.
    *
    * @param {number}   lineStart - Start line of file / module.
    * @param {number}   lineEnd - End line of file / module.
    */
   constructor(lineStart, lineEnd)
   {
      super(new MethodReport(&apos;&apos;, lineStart, lineEnd, 0));

      /**
       * Stores the aggregate MethodReport for the module.
       * @type {MethodReport}
       */
      this.aggregate = this._methodReport;

      /**
       * Stores all ClassReport data for the module.
       * @type {Array&lt;ClassReport&gt;}
       */
      this.classes = [];

      /**
       * Stores all parsed dependencies.
       * @type {Array}
       */
      this.dependencies = [];

      /**
       * Stores the end line for the module / file.
       * @type {number}
       */
      this.lineEnd = lineEnd;

      /**
       * Stores the start line for the module / file.
       * @type {number}
       */
      this.lineStart = lineStart;

      /**
       * Stores the maintainability index for a report.
       * @type {number}
       */
      this.maintainability = 171;

      /**
       * Stores all module MethodReport data found outside of any ES6 classes.
       * @type {Array&lt;MethodReport&gt;}
       */
      this.methods = [];

      /**
       * Stores the current class report scope stack.
       * @type {Array&lt;ClassReport&gt;}
       */
      this._scopeStackClass = [];

      /**
       * Stores the current method report scope stack.
       * @type {Array&lt;MethodReport&gt;}
       */
      this._scopeStackMethod = [];
   }

   /**
    * Potentially adds given dependencies for tracking.
    *
    * @param {object|Array}   dependencies - Dependencies to add.
    */
   addDependencies(dependencies)
   {
      if (typeof dependencies === &apos;object&apos; || Array.isArray(dependencies))
      {
         this.dependencies = this.dependencies.concat(dependencies);
      }
   }

   /**
    * Creates a report scope when a class or method is entered.
    *
    * @param {string}   type - Type of report to create.
    * @param {string}   name - Name of the class or method.
    * @param {number}   lineStart - Start line of method.
    * @param {number}   lineEnd - End line of method.
    * @param {number}   params - Number of parameters for method.
    *
    * @return {object}
    */
   createScope(type, name = &apos;&apos;, lineStart = 0, lineEnd = 0, params = 0)
   {
      let report;

      switch (type)
      {
         case &apos;class&apos;:
            report = new ClassReport(name, lineStart, lineEnd);
            this.classes.push(report);
            this._scopeStackClass.push(report);
            break;

         case &apos;method&apos;:
         {
            report = new MethodReport(name, lineStart, lineEnd, params);

            // Increment aggregate method report params.
            this.incrementParams(params);

            // If an existing class report / scope exists also push the method to the class report.
            const classReport = this.getCurrentClassReport();

            if (classReport)
            {
               classReport.incrementParams(params);
               classReport.methods.push(report);
            }
            else
            {
               // Add this report to the module methods as there is no current class report.
               this.methods.push(report);
            }

            this._scopeStackMethod.push(report);

            break;
         }

         default:
            throw new Error(`createScope error: Unknown scope type (${type}).`);
      }

      return report;
   }

   /**
    * Cleans up any house keeping member variables.
    *
    * @returns {ModuleReport}
    */
   finalize()
   {
      super.finalize();

      delete this._scopeStackClass;
      delete this._scopeStackMethod;

      return this;
   }

   /**
    * Returns the current class report.
    *
    * @returns {ClassReport}
    */
   getCurrentClassReport()
   {
      return this._scopeStackClass.length &gt; 0 ? this._scopeStackClass[this._scopeStackClass.length - 1] : void 0;
   }

   /**
    * Returns the current method report.
    *
    * @returns {MethodReport}
    */
   getCurrentMethodReport()
   {
      return this._scopeStackMethod.length &gt; 0 ? this._scopeStackMethod[this._scopeStackMethod.length - 1] : void 0;
   }

   /**
    * Increments the Halstead `metric` for the given `identifier` for the ModuleReport and any current class or method
    * report being tracked.
    *
    * @param {string}   metric - A Halstead metric name.
    * @param {string}   identifier - A Halstead identifier name.
    */
   halsteadItemEncountered(metric, identifier)
   {
      const currentClassReport = this.getCurrentClassReport();
      const currentMethodReport = this.getCurrentMethodReport();

      this.incrementHalsteadItems(metric, identifier);

      if (currentClassReport) { currentClassReport.incrementHalsteadItems(metric, identifier); }

      if (currentMethodReport) { currentMethodReport.incrementHalsteadItems(metric, identifier); }
   }

   /**
    * Increments the cyclomatic metric for the ModuleReport and any current class or method report being tracked.
    *
    * @param {number}   amount - Amount to increment.
    */
   incrementCyclomatic(amount)
   {
      const currentClassReport = this.getCurrentClassReport();
      const currentMethodReport = this.getCurrentMethodReport();

      this.aggregate.cyclomatic += amount;

      if (currentClassReport) { currentClassReport.aggregate.cyclomatic += amount; }
      if (currentMethodReport) { currentMethodReport.cyclomatic += amount; }
   }

   /**
    * Increments the logical SLOC (source lines of code) metric for the ModuleReport and any current class or method
    * report being tracked.
    *
    * @param {number}   amount - Amount to increment.
    */
   incrementLogicalSloc(amount)
   {
      const currentClassReport = this.getCurrentClassReport();
      const currentMethodReport = this.getCurrentMethodReport();

      this.aggregate.sloc.logical += amount;

      if (currentClassReport) { currentClassReport.aggregate.sloc.logical += amount; }
      if (currentMethodReport) { currentMethodReport.sloc.logical += amount; }
   }

   /**
    * Pops a report scope.
    *
    * @param {string} type - The report scope `class` or `method` to pop off the given stack.
    * @returns {*}
    */
   popScope(type)
   {
      switch (type)
      {
         case &apos;class&apos;:
            this._scopeStackClass.pop();
            return this.getCurrentClassReport();

         case &apos;method&apos;:
            this._scopeStackMethod.pop();
            return this.getCurrentMethodReport();

         default:
            throw new Error(`popScope error: Unknown scope type (${type}).`);
      }
   }
}
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.5.0-alpha)</span></a>
</footer>

<script src="script/jquery/jquery.min.js"></script>
<script src="script/navigation/enhancednav.js"></script>
<script defer src="script/mdl/material.min.js"></script>
<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
